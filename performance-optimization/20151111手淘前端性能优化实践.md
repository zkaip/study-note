2015双11手机淘宝前端页面性能优化实践
===

### 传统优化
---
#### 请求数优化
- 在请求数控制方面，将js，css各用combo的方式合并成单个资源。
- 页面图片等等，只加载首屏资源，提升首屏展示速度。
- 使用CSS ,SVG,ICONFONT 替换UI图片(移动端只使用`ttf`一种字体)

#### 首屏多个动态接口合并请求
#### 禁止重定向(前端JS来进行界面跳转会造成重大性能损耗)
#### 图片优化
- 使用`WebP`格式
- 生成多种规格图片按需提供
  - q值：根据手淘网络情况，加载不同质量的商品图片（q30,q50,q75,q90）
  - 锐化：根据需要调整图片锐化值
  - DPI：根据设备DPI取适当尺寸商品图片
  - 合理的使用CDN图片尺寸可以带来下载图片的性能提升，还可以减少不必要的内存消耗。 我们日常中会用到的尺寸，每浪费10像素的宽高都可以造成很大的内存资源浪费。
- 生成合理紧凑的雪碧图
- 2X Q30 看起来比 1X Q90 的`jpeg`质量更好，所以加载质量差的图片缩小1倍尺寸放置在所需位置即可

### 结合Native优化
---
#### HTTPDNS
- 防止域名劫持
- 更精准的调度
- 更小的解析延迟和波动
- 额外的域名相关信息

#### SSL+SPDY协议+域名收敛
理论上SPDY协议可以完成多路复用的加密全双工通道，显著提升非wifi环境下的网络体验。
- 多路复用请求优化
- 服务器推送技术
- SPDY压缩http头

减少域名数量可以降低DNS解析的成本。SPDY协议，其中一个特性就是复用请求，使用同一个域名可以更多的复用请求。
域名最终形态（建议）
- 页面请求 域名一个
- 静态资源（css，js） 一个
- 图片资源 一个
- 动态数据一个
- 数据统计一个

#### 动态数据复用状态
#### 预加载和离线化方案
将静态资源通过`Hybrid`的方式提前加载到本地。大量了资源预加载给H5页面带来了极大的提升，资源加载时间降到30ms内。
#### 统计方案优化(异步提交统计信息)
#### 渲染优化
- 禁止使用iframe （阻塞父文档onload事件）
- 禁止使用GIF图片实现Loading 效果 （降低CPU消耗，提升渲染性能）视频。
业务

### 参考
- [15年双11手淘前端技术巡演 - H5性能最佳实践](https://github.com/amfe/article/issues/21)